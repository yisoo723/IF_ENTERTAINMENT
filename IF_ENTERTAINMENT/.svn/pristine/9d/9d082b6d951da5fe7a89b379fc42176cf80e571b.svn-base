<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ taglib uri="http://www.springframework.org/security/tags" prefix="sec" %>
<!DOCTYPE html>
<head>
<meta charset="UTF-8">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>
<script src="${pageContext.request.contextPath }/resources/js/main.min.js"></script>
<script src="${pageContext.request.contextPath }/resources/js/script.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="" />
<meta name="keywords" content="" />

<link rel="stylesheet" href="${pageContext.request.contextPath }/resources/css/main.min.css">
<link rel="stylesheet" href="${pageContext.request.contextPath }/resources/css/style.css">
<link rel="stylesheet" href="${pageContext.request.contextPath }/resources/css/color.css">
<link rel="stylesheet" href="${pageContext.request.contextPath }/resources/css/responsive.css">
<link rel="icon" href="${pageContext.request.contextPath }/resources/images/fav.png" type="image/png" sizes="16x16">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.10/dist/sweetalert2.min.css">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.10/dist/sweetalert2.min.js"></script>
<title>íšŒì›ì •ë³´ ìˆ˜ì •í•˜ê¸°</title>
<meta id="_csrf" name="_csrf" content=${_csrf.token }>
<meta id="_csrf_header" name="_csrf_header" content=${_csrf.headerName }>
	

<style type="text/css">
@font-face {
	font-family: 'LOTTERIACHAB';
	src:
		url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2302@1.0/LOTTERIACHAB.woff2')
		format('woff2');
	font-weight: normal;
	font-style: normal;
}

@font-face {
	font-family: 'GmarketSansMedium';
	src:
		url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2001@1.1/GmarketSansMedium.woff')
		format('woff');
	font-weight: normal;
	font-style: normal;
}

body {
	font-family: 'GmarketSansMedium', sans-serif;
}

.medium-opacity:before {
	-webkit-opacity: .3;
	-moz-opacity: .3;
	-ms-opacity: .3;
	-o-opacity: .3;
	opacity: .3;
}

.radio {
	display: flex;
	flex-direction: row;
}

.frame {
	width: 90%;
	margin: 40px auto;
	text-align: center;
}

.custom-btn {
	width: 130px;
	height: 40px;
	color: #fff;
	border-radius: 5px;
	padding: 10px 25px;
	font-weight: 500;
	background: transparent;
	cursor: pointer;
	transition: all 0.3s ease;
	position: relative;
	display: inline-block;
	box-shadow: inset 2px 2px 2px 0px rgba(255, 255, 255, .5), 7px 7px 20px
		0px rgba(0, 0, 0, .1), 4px 4px 5px 0px rgba(0, 0, 0, .1);
	outline: none;
}

.btn-16 {
	border: none;
}

.btn-16:after {
	position: absolute;
	content: "";
	width: 0;
	height: 100%;
	top: 0;
	left: 0;
	direction: rtl;
	z-index: -1;
	box-shadow: -7px -7px 20px 0px #fff9, -4px -4px 5px 0px #fff9, 7px 7px
		20px 0px #0002, 4px 4px 5px 0px #0001;
	transition: all 0.3s ease;
}

.btn-16:hover {
	color: #fff;
	background: #6f42c1;
}

.btn-16:hover:after {
	left: auto;
	right: 0;
	width: 100%;
	border-radius: 7px;
}

.btn-16:active {
	top: 2px;
}

.big-ad>figure {
	margin-bottom: 0;
}
</style>
</head>
<body>
	<div class="www-layout">
		<section>
			<div class="gap no-gap signin whitish medium-opacity register">
				<div class="bg-image"
					style="background-image: url(https://incheontimes.co.kr/boardImage/incheontimes/20230118/MC4wMDQ2NDQwMCAxNjczOTQwNjk5.jpg)">
				</div>
				<div class="container">
					<div class="row">
						<div class="col-lg-3">
							<div class="big-ad" style="text-align: center;">
								
								<form method="post" id="userVO" enctype="multipart/form-data">
								<div class="profile-author-thumb">
									<img src="${userVO.userProfile}" alt="${pageContext.request.contextPath }" style="width: 150px; height: 150px;">
									<div class="edit-dp">
										<label class="fileContainer"> <i class="fa fa-camera"></i>
											<input type="file" id="myFile" name="myFile" data-userno="${userVO.userNo }">
										</label>
									</div>
								</div>
								<sec:csrfInput/>
								</form>
								
								
								<figure
									style="font-family: 'LOTTERIACHAB'; font-size: 30px; padding: 10px; color: white;">
									If entertainment
									<br/>Fan ${userVO.userName } ë‹˜
									<i class="fa-brands fa-waze"></i>
								</figure>
								
								<div>
 <button class="custom-btn btn-16">íƒˆí‡´í•˜ê¸°</button>
 <button class="custom-btn btn-16">ë’¤ë¡œê°€ê¸°</button>
							</div>
							
							</div>

						</div>
						<div class="col-lg-9">
							<div class="reg-from" style="margin-top: 100px;">
								<span>ğŸ› ï¸íšŒì›ì •ë³´ ìˆ˜ì •í•˜ê¸°</span>
								<p>íšŒì›ë‹˜ì˜ ì†Œì¤‘í•œ ì •ë³´ë¥¼ ì•ˆì „í•˜ê²Œ ê´€ë¦¬í•˜ì„¸ìš” â—</p>

								<form class="c-form" mthoed="post">
									<div class="row merged10">
										<div class="col-lg-6 col-md-6 col-sm-6">
											<label>ğŸ†” ì•„ì´ë””  </label>
											<input class="mb-2" type="text"  value="${userVO.userId }"
												placeholder="ID">
										</div>
										<div class="col-lg-6 col-md-6 col-sm-6">
											<label>ğŸ‘‘ ì´ë¦„</label> <input class="mb-2" type="text" value="${userVO.userName }"
												placeholder="Name">
										</div>
										
										<div class="col-lg-12 col-md-12 col-sm-12">
										<span><br></span>
										</div>
										
										<div class="col-lg-6 col-md-6 col-sm-6">
											<label>ğŸ” ìƒˆ ë¹„ë°€ë²ˆí˜¸</label>
										<input class="mb-2" type="password" id="userPw" name="userPw" 
											placeholder="ë³€ê²½í•  ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”">
										</div>
										<div class="col-lg-6 col-md-6 col-sm-6">
											<label>ğŸ” ìƒˆ ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
											<input class="mb-2" type="password" id="userPw1" name="userPw1"
												placeholder="ë³€ê²½í•  ë¹„ë°€ë²ˆí˜¸ë¥¼ í•œë²ˆ ë” ì…ë ¥í•´ì£¼ì„¸ìš”">
										</div>
										
										<div id="message"></div>
										
										<div class="col-lg-12 col-md-12 col-sm-12">
										<span><br></span>
										</div>
										
										<div class="col-lg-2 col-md-2 col-sm-2">
												<label>ğŸ‘« ì„±ë³„</label>
												<input class="mb-2" type="text"
												value="${userVO.memberGender }">
										</div>
										
										<div class="col-lg-4 col-md-4 col-sm-4">
											<label>ğŸ“… ìƒë…„ì›”ì¼</label> <input class="mb-2" type="text"
												value="${userVO.memberBirth }">
										</div>
										<div class="col-lg-6 col-md-6 col-sm-6">
											<label>ğŸ“± ì „í™”ë²ˆí˜¸</label> <input class="mb-2" type="text"
												value="${userVO.memberTelno }">
										</div>
										
										<div class="col-lg-12 col-md-12 col-sm-12">
										<span><br></span>
										</div>
										
										<div class="col-lg-12 col-md-12 col-sm-12">
										<span><br></span>
										</div>
										
										<div class="col-lg-12 col-md-12 col-sm-12">
											<label>ğŸ’Œ ì´ë©”ì¼</label> <input class="mb-2" type="text"
												value="${userVO.memberEmail }">
										</div>
										
										<div class="col-lg-12 col-md-12 col-sm-12">
										<span><br></span>
										</div>
										
										<div class="col-lg-2 col-md-2 col-sm-2">
											<label>ğŸ“« ìš°í¸ë²ˆí˜¸</label> <input class="mb-2" 
												value="${userVO.memberPostcode }">
										</div>
										<div class="col-lg-5 col-md-5 col-sm-5">
											<label>ğŸš© ì£¼ì†Œ</label> <input class="mb-2" 
												value="${userVO.memberAddress1 }">
										</div>
										<div class="col-lg-5 col-md-5 col-sm-5">
											<label>ìƒì„¸ì£¼ì†Œ</label> <input class="mb-2"
												value="${userVO.memberAddress2 }">
										</div>
										
										<div class="col-lg-12 col-md-12 col-sm-12">
										<span><br></span>
										</div>
										
										<div class="col-lg-5 col-md-5 col-sm-5">
											<div class="gender mb-2">
												<label>ğŸ’¡ ì•Œë¦¼ìˆ˜ì‹  ì—¬ë¶€</label>
												<div class="form-radio">
													<div class="radio" style="border: none; background: none; display: flex;">
				<label style="width: 250px;">
					<input type="radio" name="receive_option" <c:if test="${userVO.memberNotification eq 'Y' }">checked</c:if>>
					<i class="check-box"></i>ë™ì˜
				</label>
				
				<label>
					<input type="radio" <c:if test="${userVO.memberNotification ne 'Y' }">checked</c:if> name="receive_option">
					<i class="check-box"></i> ë¹„ë™ì˜
				</label>
													</div>
												</div>
											</div>
										</div>
										
										<div class="col-lg-7 col-md-7 col-sm-7">
											<div class="gender mb-2">
												<label>ğŸš€ ì•Œë¦¼ìˆ˜ì‹  ì±„ë„ ì„ íƒ</label>
												<div class="form-radio">
													<div class="radio" style="border: none; background: none; display: flex;">
				<label>
					<input type="checkbox" name="channel_option"
					<c:if test="${userVO.nsGoods eq 'Y' && userVO.nsArtist eq 'Y' && userVO.nsCompany eq 'Y' }">checked</c:if>>
					<i class="check-box"></i>ì „ì²´ë™ì˜
				</label>
				
				<label>
					<input type="checkbox" name="channel_option" <c:if test="${userVO.nsArtist eq 'Y'}">checked</c:if>>
					<i class="check-box"></i>ì»¤ë®¤ë‹ˆí‹°
				</label>
				
				<label>
					<input type="checkbox" name="channel_option" <c:if test="${userVO.nsGoods eq 'Y'}">checked</c:if>>
					<i class="check-box"></i>êµ¿ì¦ˆìƒµ
				</label>
				
				<label>
					<input type="checkbox" name="channel_option" <c:if test="${userVO.nsCompany eq 'Y'}">checked</c:if>>
					<i class="check-box"></i>ì´ë²¤íŠ¸
				</label>
														
													</div>
												</div>
											</div>
										</div>
										
										<div class="col-lg-12 col-md-12 col-sm-12 mb-2">
											<div class="checkbox mb-1">
												<label>
													<input type="checkbox" <c:if test="${userVO.memberNotification eq 'Y'}">checked</c:if>>
													<i class="check-box"></i> ì„œë¹„ìŠ¤Â·ì´ë²¤íŠ¸ ì •ë³´ ìˆ˜ì‹ ì— ë™ì˜í•©ë‹ˆë‹¤.
												</label>
											</div>
										</div>
										
										<div class="col-lg-8 col-md-6 mt-2">
											<span class="reg-with">Register With</span>
											<ul class="social-reg">
												<li>
												<a class="facebook" href="#" title="" data-ripple="">êµ¿ì¦ˆìƒµ ì´ìš©</a>
												</li>
												<li>
												<a class="twitter" href="#" title="" data-ripple="">
												ì»¤ë®¤ë‹ˆí‹° ì´ìš©</a></li>
											</ul>
										</div>
										<div class="col-lg-4 col-md-6 mt-2">
											<button type="submit">íšŒì›ì •ë³´ ìˆ˜ì •í•˜ê¸°</button>
										</div>
									</div>
									<sec:csrfInput/>
								</form>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>
	</div>
</body>

<script type="text/javascript">
var header = "";
var token = "";
$(function(){
	// ì‹œíë¦¬í‹° ì ìš© ì‹œ, header í‚¤ ê°’ê³¼ í† í°ì„ ì„¤ì • 
	// (ë™ì  í˜ì´ì§€ë§ˆë‹¤ ì „ì—­ë³€ìˆ˜ë¡œ ì„¤ì •ëœ header, tokenì„ ê°€ì ¸ë‹¤ ì“¸ ìˆ˜ ìˆë‹¤)
	header = $("meta[name='_csrf_header']").attr("content");
	token = $("meta[name='_csrf']").attr("content");
});

// í”„ë¡œí•„ ì‚¬ì§„ ë³€ê²½ ë° ì €ì¥ 
$("#myFile").on("change", function(event){
	var file = event.target.files[0];
	var userNo = $(this).data("userno");
	var formData = new FormData();
	formData.append("file", file);
	formData.append("userNo", userNo);
	
	$.ajax({
		url : "/community/mypage/uploadAjax",
		type : "post",
		beforeSend: function(xhr){
			xhr.setRequestHeader(header, token);
		},
		data : formData,
		dataType : "text", // ë¹„ë™ê¸° í†µì‹ ì˜ ìµœì¢… ê²°ê³¼ë¬¼ì„ text í˜•ì‹ìœ¼ë¡œ ë°›ê² ë‹¤ê³  ì•Œë¦¬ê³  ì „ë‹¬ë˜ëŠ” ì„œë²„ ë©”ì†Œë“œì—ì„œëŠ” producesë¥¼ í†µí•´ í…ìŠ¤íŠ¸ ì¸ê²ƒì„ ì¸ì§€í•˜ê³  ë°›ëŠ”ë‹¤
		processData : false, // ì´ì§„ ë°ì´í„°ë¡œ ì§ë ¬í™”ê°€ ë˜ì–´ íŒŒì¼ì´ ì œëŒ€ë¡œ ì „ì†¡ë˜ì§€ ì•Šê²Œ ë˜ëŠ”ê²ƒì„ ë§‰ëŠ”ë‹¤ (Defaultê°’ì€ true)
		contentType : false,
		success : function(data){
			$("#thumbLink").attr("href", "/community/mypage/displayFile?fileName=" + data);
		}
	});
	
	
	if(isimgFile(file)){ // ì´ë¯¸ì§€ì¸ì§€ë¥¼ ì²´í¬í•˜ì—¬ ë‹¤ë¥¸ íƒ€ì…ì€ íŒŒì¼ì„ ì—…ë¡œë“œí•  ìˆ˜ ì—†ë„ë¡ í•œë‹¤.
		var reader = new FileReader();
		reader.onload = function (e) {
			$("#thumimg").attr("src", e.target.result);
		}
		reader.readAsDataURL(file);
		thumbPassed = true;
	}else {
		Swal.fire({
			icon : "error",
			title : "ì´ë¯¸ì§€ íŒŒì¼ë§Œ ë“±ë¡ê°€ëŠ¥í•©ë‹ˆë‹¤.",
			showConfirmButton : false,
			timer : 1500
		});
		thumbPassed = false;
	}
	
	});	
	
	//ì„ì‹œ íŒŒì¼ë¡œ ì¸ë„¤ì¼ ì´ë¯¸ì§€ ë§Œë“¤ê¸°
	function getThumbnailName(fileName){
	var front = fileName.substr(0, 12); // /2024/03/06/ í´ë” 
	var end = fileName.substr(12); // ë’¤ íŒŒì¼ëª…
	
	console.log("front : " + front);
	console.log("end : " + end);
	
	return front + "s_" + end;
	}
	
	// íŒŒì¼ì˜ íƒ€ì…ì„ ë¦¬í„´í•´ì¤€ë‹¤.
	function isimgFile(file) {
		var ext = file.name.split(".").pop().toLowerCase(); // íŒŒì¼ëª…ì—ì„œ í™•ì¥ìë¥¼ ê°€ì ¸ì˜¨ë‹¤.
		return ($.inArray(ext,["jpg","jpeg","png", "gif"]) === -1) ? false : true;
	}
    
    document.getElementById("myFile").onchange = function(event) {
        var file = event.target.files[0];
        var reader = new FileReader();
        reader.onload = function(){
            var thumbnail = document.querySelector('.profile-author-thumb img');
            thumbnail.src = reader.result;
            Swal.fire({
                title: 'í”„ë¡œí•„ ì‚¬ì§„ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤!',
                icon: 'success'
            });
        };
        reader.readAsDataURL(file);
    };
    
  //ë¹„ë°€ë²ˆí˜¸
    document.addEventListener('DOMContentLoaded', function() {
        var pwInput = document.getElementById('userPw');
        var confirmpwInput = document.getElementById('userPw1');
        var message = document.getElementById('message');

        function validate() {
            if (confirmpwInput.value !== '') {
                if (pwInput.value === confirmpwInput.value) {
                    message.innerHTML = 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•©ë‹ˆë‹¤.';
                    message.style.color = 'green';
                } else {
                    message.innerHTML = 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.';
                    message.style.color = 'red';
                }
            } else {
                message.innerHTML = '';
            }
        }
        pwInput.addEventListener('input', validate);
        confirmpwInput.addEventListener('input', validate);
    });
</script>

