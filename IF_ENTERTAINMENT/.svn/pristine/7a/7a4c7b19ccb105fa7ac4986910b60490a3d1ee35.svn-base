<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ taglib uri="http://www.springframework.org/security/tags" prefix="sec" %>
<script type="text/javascript" src="${pageContext.request.contextPath }/resources/ckeditor/ckeditor.js"></script>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" >
<script src="https://code.jquery.com/jquery-3.2.1.js"></script>
<c:set value="ë“±ë¡" var="name" />
<c:if test="${status eq 'u' }">
	<c:set value="ìˆ˜ì •" var="name" />
</c:if>
<div class="gap no-gap">
	<div class="inner-bg">
		<div class="element-title">
			<h4>ğŸ“° ê¸°ì—…ì†Œì‹ ${name }</h4>
		</div>
		<form method="post" action="/entertain/company/news/insert.do"
			id="CompanyNewsForm">
			<c:if test="${status eq 'u' }">
				<input type="hidden" name="bfNo" value="${companyNews.bfNo }" />
			</c:if>
			<div class="add-prod-from">
				<div class="row">
					<div class="col-md-12">
						<label>ì œëª©</label> <input type="text" id="bfTitle" name="bfTitle"
							value="${companyNews.bfTitle }" placeholder="ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”">
					</div>
					<div class="col-md-12">
						<label>ë‚´ìš© ì…ë ¥</label>
						<textarea id="bfContent" name="bfContent">${companyNews.bfContent }</textarea>
					</div>
					<div class="col-md-12">
						<div class="buttonz">
							<button type="button" id="addBtn">${name }</button>
							<c:if test="${status ne 'u' }">
								<button type="button" id="listBtn">ëª©ë¡</button>
							</c:if>
							<c:if test="${status eq 'u' }">
								<button type="button" id="deletelBtn">ì‚­ì œ</button>
								<button type="button" id="cancelBtn">ì·¨ì†Œ</button>
							</c:if>
						</div>
					</div>
				</div>
			</div>
			<sec:csrfInput />
		</form>
	</div>
</div>
<script type="text/javascript">
	$(function() {
		CKEDITOR
				.replace(
						"bfContent",
						{
							filebrowserUploadUrl : '/imageUpload.do?${_csrf.parameterName}=${_csrf.token}'
						});

		var CompanyNewsForm = $("#CompanyNewsForm");
		var listBtn = $("#listBtn");
		var addBtn = $("#addBtn");
		var cancelBtn = $("#cancelBtn");

		listBtn.on("click", function() {
			location.href = "/entertain/company/news/list.do";
		});

		addBtn.on("click", function() {
			var title = $("#bfTitle").val();
			// ckeditorë¥¼ ì´ìš©í•œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë°©ë²•
			var content = CKEDITOR.instances.bfContent.getData();

			if (title == null || title == "") {
				alert("ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!");
				$("#bfTitle").focus();
				return false;
			}

			if (content == null || content == "") {
				alert("ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!");
				$("#bfContent").focus();
				return false;
			}

			if ($(this).text() == "ìˆ˜ì •") {
				CompanyNewsForm.attr("action",
						"/entertain/company/news/update.do");
			}

			CompanyNewsForm.submit();
		});

		cancelBtn.on("click", function() {
			location.href = "/entertain/company/news/list.do"
		});

	});
</script>