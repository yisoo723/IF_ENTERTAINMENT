<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt" %>
<script src="//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.10/dist/sweetalert2.min.css">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.10/dist/sweetalert2.min.js"></script>
<style>
.qTitle {
    margin-top: 10px;
    margin-bottom: 30px;
}

/* 라디오 버튼 및 체크박스 숨기기 */
input[type="radio"],
input[type="checkbox"] {
    display: none;
}

/* 사용자 정의 라디오 버튼 및 체크박스 디자인 */
input[type="radio"] + label,
input[type="checkbox"] + label {
    display: inline-block;
    width: 20px;
    height: 20px;
    border: 2px solid #707070;
    border-radius: 30%;
    position: relative;
    text-align: center;
    line-height: 30px;
}

/* 라디오 버튼 및 체크박스가 선택됐을 때의 스타일 */
input[type="radio"]:checked + label::after,
input[type="checkbox"]:checked + label::after {
    content: '\2713'; /* ✔ */
    font-size: 15px; /* 선택된 상태에서의 크기 */
    line-height: 20px; /* 선택된 상태에서의 높이 */
    text-align: center;
    color: #707070; /* 선택된 상태에서의 색상 */
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
}

.options {
	display: flex;
}

.op_label {
	margin-right: 10px;
}
.dupl {
	margin-left: 20px;
	color: gray;
	font-size: 14px;
}
.fa.fa-gear:before {
    position: relative;
    left: 1470px;
    top: 40px;
    content: "\f013";
    cursor: pointer;
    font-size: 30px;
}
.fa-gear {
    color: #707070; /* 아이콘의 초기 색상을 설정합니다. */
    transition: color 0.3s ease; /* 호버 효과를 부드럽게 만듭니다. */
}

.fa-gear:hover {
    color: #a876e8; /* 호버 상태에서 아이콘의 색상을 변경합니다. */
}
.basicInfo {
	display: flex;
}


/* 셀렉트 박스 스타일 */
select {
    margin-top: -7px;
    margin-bottom: 20px;
    font-family: inherit;
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    background-color: #f4f8ff;
    border: 1px solid #eaeaea;
    padding: 8px 12px;
    border-radius: 5px;
    width: 214px;
    font-size: 13px;
    color: #333333;
    cursor: pointer;
    outline: none;
    height: 37px;
    position: relative;
}

/* 셀렉트 박스 드롭다운 스타일 */
select option {
	font-family: inherit;
    background-color: #f4f8ff;
    color: #333333;
}

#upload-span{
	display: block;	
}

/* 데이트피커 */
.datepicker {
    font-family: inherit;
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    background-color: #f4f8ff;
    border: 1px solid #eaeaea;
    padding: 12px;
    border-radius: 5px;
    width: calc(50% - 6px); 
    font-size: 14px;
    color: #333333;
    cursor: pointer;
    outline: none;
    height: 50px;
    position: relative;
}

#rows div, #surveyQuestion div {
	margin-bottom: 20px;
}

.dateForm {
	display: flex;
	flex-direction: column;
}

#surveyFormTitle {
	margin-bottom: 55px;
}
#surveyFormDisplay{
	margin-top: 50px;
}

.lis:first-child {
	padding-top: 20px;
    border-top: 1px solid #dfdfdf;
}

#sfTitle{
	width: 1135px;
}

#rows {
	padding: 35px;
}
#thumimg {
	width: 500px;
}
#op_label {
	left: 15px;
    bottom: -18px;
}

#modiQuestion{
	position: relative;
    bottom: -30px;
    left: 1335px;
    font-size: 20px;
    display: none;
}

</style>

<div class="col-md-12">
    <div class="widget">
    			<div class="add-prod-from">
    			<i class="fa fa-gear" id="modiForm"></i>
			<form action="" method="post" id="surveyForm" enctype="multipart/form-data">
				<div class="row" id="rows">
					<div class="col-md-12" id="surveyFormTitle">
						<div style="padding: 0; margin: 0;">
							<label>제목</label>
						</div>
						<input type="text" id="sfTitle" name="sfTitle" value="${surveyFormVO.sfTitle }" class="formInfo" disabled="disabled">
					</div>
					<div class="col-md-12" style="margin-top: 45px;">
						<span id="upload-span" class="upload-image">썸네일</span> 
						<label class="fileContainer" style="width: 500px;">
							<span id="vertical">upload</span>
							<input type="file" id="sfFile" name="sfFile" class="formInfo" disabled="disabled"/>
						</label>
						<div id="thumimgBox">
<!-- 							<a href="#" target="_blank" id="thumbLink"> -->
								<img id="thumimg" src="${surveyFormVO.sfPhoto }" alt="" >
<!-- 							</a> -->
						</div>
					</div>

					<div class="col-md-6 dateForm">
						<label>시작일</label> 
						<input type="date" class="datepicker startDate" id="sfRegdate" name="sfRegdate" style="width: 500px;" class="formInfo"
						 value="<fmt:formatDate value="${surveyFormVO.sfRegdate }" pattern="yyyy-MM-dd" />" disabled="disabled"/>
						
					</div>

					<div class="col-md-6  dateForm" style="right: 129px;">
						<label>마감일</label> 
						<input type="date" class="datepicker endDate" id="sfEnddate" name="sfEnddate" style="width: 500px;" class="formInfo"
						value="<fmt:formatDate value="${surveyFormVO.sfEnddate }" pattern="yyyy-MM-dd" />" disabled="disabled"/>
					</div>

					<div class="col-md-4" id="surveyFormDisplay" style="margin-bottom: 45px;">
					    <label for="sfDisplay">팝업 등록 여부</label> 
					    
					    <input type="checkbox" class="clickHere" id="sfDisplay" name="sfDisplay" value="Y" class="formInfo"
					    <c:if test="${surveyFormVO.sfDisplay eq 'Y' }">checked</c:if> disabled="disabled"/>
					    <label for="sfDisplay" class="op_label" id="op_label"></label>
					</div>
				</div>
			</form>
		</div>
        <div class="widget-peding">
            <ul class="q-comments support">
                <c:forEach items="${surveyFormVO.surveyQuestionList}" var="question">
                    <li class="lis">
                    	<i class="fa fa-pencil" id="modiQuestion"></i>
                        <div class="comment-detail">
                            <h4 class="qTitle">
                            	<input type="hidden" name="sqNo" value="${question.sqNo }">
                            	<input type="text" name="sqTitle" value="${question.sqTitle}" disabled="disabled">  
	                            <span class="dupl">
	                            	<c:if test="${question.sqType eq 'checkbox' }">(중복선택 가능)</c:if>
	                            </span>
                            </h4>
                            <span>
                            	<select name="" class="sqTypes" disabled="disabled">
                            		<option value="">유형을 선택해주세요</option>
                            		<option value="radio" <c:if test="${question.sqType eq 'radio' }">selected</c:if>>단일선텍형</option>
                            		<option value="checkbox" <c:if test="${question.sqType eq 'checkbox' }">selected</c:if>>복수선택형</option>
                            	</select>
                            </span>
                            <c:forEach items="${question.optionList}" var="option" varStatus="stat">
                                <p class="options">
                                    <input id="option_${option.soNo}" class="clickHere" type="${question.sqType}" name="srAnswer" disabled="disabled"/>
                                    <label for="option_${option.soNo}" class="op_label"></label>
                                    <input type="text" class="newOption" name="" value="${option.soContent}" disabled="disabled">
                                </p>
                            </c:forEach>
                        </div>
                    </li>
                </c:forEach>
            </ul>
        </div>
    </div>
</div>

<script type="text/javascript">
	$(function(){
		
		var startDate = $("#sfRegdate").val();
		var endDate = $("#sfEnddate").val();
		
		var modiForm = $("#modiForm");
		
		modiForm.on("click", function(){
			$(".formInfo").removeAttr("disabled");
			$("#sfFile").removeAttr("disabled");
			$("#sfRegdate").removeAttr("disabled");
			$("#sfEnddate").removeAttr("disabled");
			$("#sfDisplay").removeAttr("disabled");
		});
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		// 날짜관련		
		$(".datepicker").datepicker(
			{
				dateFormat : 'yy-MM-dd',
				showOtherMonths : true,
				showMonthAfterYear : true,
				changeYear : true,
				changeMonth : true,
				showOn : "both",
				buttonText : "선택",
				yearSuffix : "년",
				monthNamesShort : [ '1월', '2월', '3월', '4월', '5월', '6월',
						'7월', '8월', '9월', '10월', '11월', '12월' ],
				monthNames : [ '1월', '2월', '3월', '4월', '5월', '6월', '7월',
						'8월', '9월', '10월', '11월', '12월' ],
				dayNamesMin : [ '일', '월', '화', '수', '목', '금', '토' ],
				dayNames : [ '일요일', '월요일', '화요일', '수요일', '목요일', '금요일',
						'토요일' ],
				minDate : "-5Y",
				maxDate : "+5y",
			});
		
		// 시작일을 선택했을 때 그 날짜를 저장한다
		$("#sfRegdate").on("change", function() {
			startDate = new Date($(this).val());
			console.log(startDate);
			if (startDate > endDate) {
				Swal.fire({
					icon : "error",
					title : "<div style='font-size:22px'>시작일은 마감일보다 늦을 수 없습니다.</div>",
					showConfirmButton : false,
					timer : 2000
				});
				$(this).val("");
				return false;
			} 
		});

		// 종료일을 선택했을 때 그 날짜를 시작일과 비교하여 전이라면 값 변경을 강제한다.
		$("#sfEnddate").on("change", function() {
			endDate = new Date($(this).val());
			console.log(endDate);
			if (startDate > endDate) {
				Swal.fire({
					icon : "error",
					title : "<div style='font-size:22px'>마감일은 시작일보다 빠를 수 없습니다.</div>",
					showConfirmButton : false,
					timer : 2000
				});
				$(this).val("");
				return false;
			} 
		});
	});
	// 현재 날짜를 가져온다
	var currentDate = new Date().toISOString().slice(0, 10);

	// 입력 필드에 현재 날짜를 최소 날짜로 설정
	document.getElementById("sfRegdate").setAttribute("min", currentDate);
	document.getElementById("sfEnddate").setAttribute("min", currentDate);
	
	
</script>